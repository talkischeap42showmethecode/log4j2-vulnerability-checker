import io.javalin.Javalin
import io.javalin.http.staticfiles.Location

class HttpServer {
    companion object {
        @JvmStatic
        fun main(args: Array<String>) {
            val port = args[0].toInt()
            Javalin
                .create { javalinConfig ->
                    javalinConfig.addStaticFiles { staticFileConfig ->
                        staticFileConfig.location = Location.EXTERNAL
                        staticFileConfig.directory = "/"
                        staticFileConfig.hostedPath = "./build/classes/java/main"
                        staticFileConfig.skipFileFunction = {
                            println(it.requestURI)
                            false
                        }
                    }
                    javalinConfig.addStaticFiles { staticFileConfig ->
                        staticFileConfig.location = Location.EXTERNAL
                        staticFileConfig.directory = "/"
                        staticFileConfig.hostedPath = "./build/classes/kotlin/main"
                        staticFileConfig.skipFileFunction = {
                            println(it.requestURI)
                            false
                        }
                    }
                }
                .start(port)
            println("Listening on 0.0.0.0:$port")
        }
    }
}
